[build]
command = """
  # Create SSH directory
  mkdir -p ~/.ssh

  # Write private key from Railway env var
  echo "$RAILWAY_SSH_KEY" > ~/.ssh/id_ed25519
  chmod 600 ~/.ssh/id_ed25519

  # Add GitHub to known hosts to avoid prompts
  ssh-keyscan github.com >> ~/.ssh/known_hosts

  # Rewrite https to ssh
  git config --global url."git@github.com:".insteadOf "https://github.com/"

  # Pull submodules
  git submodule sync --recursive
  git submodule update --init --recursive

  # Install and build
  pnpm install --frozen-lockfile
  pnpm build
"""